### 접근통제의 3단계

> 인가된 사용자가 비인가된 방식으로 자산을 접근하는 행위를 통제
>
> 인가된 사용자가 인가된 방식으로 실수 혹은 의도적으로 접근하여 자산을 훼손하는 행위를 통제

#### 1. 식별

	- 본인의 신원을 시스템에 밝히는 것

#### 2. 인증

- 주체의 신원을 검증하기 위한 사용 증명 활동

#### 3. 인가

- 인증된 주체에게 접근을 허용하고 특정 업무를 수행할 권리를 부여하는 과정



#### 접근통제 요구사항

- 입력의 신뢰성
  - 접근제어 시스템은 입력되는 사용자 정보를 신뢰할 수 있어야 함
- 최소 권한 부여
  - 사용자가 작업을 수행하는데 있어서 최소한의 자원과 최소한의 접근만 부여
  - 사용자로 인한 피해 최소화
  - 최대 권한과 반대 의미
- 직무 분리
  - 한 개인이 전체 업무를 파괴하는 사고를 방지하기 위해 시스템 기능의 단계를 개인에게 나누어야 함



### HTTP 기본 인증

> HTTP에서 작동하는 인증 방식의 일종

- 사용 및 구현 간편 => 여러 소프트웨어들이 기능 지원
- 사용자명과 패스워드를 `base64_encode`하여 헤더에 포함시켜 송신

- 패킷 도청에 취약

  - 패킷도청 위험이 없는 곳에서만 사용해야 함

- HTTP 인증요구/응답 과정

  - 웹 API 에서 HTTP요청 메세지 수신

  - 서버는 요청 처리/ 사용자 개인정보 요구로 응답

  - 인증 요구를 받은 클라이언트는 사용자에게 인증 정보 요청

    => 사용자: 인증 정보 추가 후 다시 요청 송신

  - 서버: 인증정보 확인

    - 문제 시 인증요구 재요청/에러반환



\#1 openssl 모듈을 이용해서 사용명과 암호화한 패스워드를 BASE64로 인코딩

```
[vagrant@master ~]$ echo "your_name:$(openssl passwd -quiet -crypt your_password)" | base64
```



- 여기서 `-quiet` 를 빼면 경고메세지가 뜬다







### 컴퓨팅 

>  물리 서버가 하는 역할을 복제한 클라우드 서비스

- EC2(elastic computing cloud)
  - 가장 많이 사용됨
  - 가상 머신 올리듯이 클라우드를 통해 가상 머신을 올리는 서비스

- Lambda:
  - 미리 설정되어있는 환경에 내 소스코드만 올려서 실행
  - 서버없이 프로그램이 도는 것처럼 느끼게 해준다
  - 내부적으로 클라우드서비스 이용

- Auto Scailing
  -  정책에 따라서 시스템을 자동으로 늘리고 줄여주는 서비스
- Elastic Load Balancing
  - 시스템에 가해지는 부하를 여러 대의 시스템으로 분산해서 규모있는 시스템을 만들 수 있도록 해주는 단일 진입점
- Elastic Beanstalk
  - 자동 배포실행환경을 만들어주는 서비스 
  - CI/CD 와 연관





### 네트워킹 

> 어플리케이션 연결, 접근 제어, 원접 연결

- **VPC(Virtual Private Cloud)**
  - 사용자의 AWS 계정 전용 가상 네트워크
- **Direct connect**
  - AWS 서비스 쪽으로 **전용 선을 구축한 것처럼 연결해주는 서비스**
- **Router54**
  - AWS에서 제공하는 도메인/메인 리졸브 서비스
  - 도메인 이름을 사용하는IP 로 전환해주는 서비스
- **CloudFront**
  - Contents Delivery 



### 스토리지 

>  빠른 액세스, 장기 백업과 같은 요구를 충족하는 스토리지 플랫폼

- S3(Simple Storage Service)
  - 객체를 저장할 수 있도록 해주는 것
  - 저장소의 개념
- Glacier
  - 장기 보관 서비스
  - 장기 백업- 쌓아 둔 것, 서비스 되지 않는 것들 중 보관해야 하는 것들 보관
  - 데이터 접근에 시간이 좀 걸린다
- EBS (Elastic Block Storage)
- Storage Gateway



데이터베이스

- RDS(Relational Database Service)
- Dynamo DB
  - NoSQL 비정형데이터를 다룬다



어플리케이션 관리

- Cloudwatch
- CloudFormation
- Config
- CloudTrail

보안과 자격 증명

- IAM
- KMS
- Directory Service

어플리케이션 통합

- SNS (Simple Notificatiokn Service)
- Simple WorkFlow (SWF)
- SQS (Simple Queue Service)
  - 큐가 있으면 어플리케이션이 큐에 데이터를 쌓는다-> 큐에 있는 데이터를 어떤 게 쓴다
  - 정산 데이터를 여러 클라우드 데이터에서 각각 만들어서 쌓는다-> 쌓인 것을 가져다가 사용
- API Gateway
  - 



AWS IAM

- 자격을 인정하고 권한 부여
- AWS 고객이 AWS 계정 및 AWS 내에서 사용 가능한 API 및 서비스에 대한 사용자의 액세스 및 권한을 관리할 수 있도록 하는 서비스
- 사용자, 보안 자격 증명을 관리하고 사용자가 AWS 리소스에 액세스할 수 있도록 허용할 수 있음



서비스를 제공하려고 하다 보면 서비스와 관련된 계정들을 다루게 된다

사용자별로 계정을 주는 케이스가 있음/ 사용자가 많아지면 관리의 효용성을 위해 그룹을 묶는 경우도 종종 있음

그룹으로 묶는 이유는 사용자들을 편리하게 통제하기 위해

개별 사용자에게 하나씩 권한을 부여하려고 하면 통제하기가 어려움-> 그룹을 만들어 사용자 추가하는 방식으로 바뀜

사용자 3명/그룹 3명

![image-20210225142744019](C:\Users\MIN\AppData\Roaming\Typora\typora-user-images\image-20210225142744019.png)

EC2 인스턴스들을 부여할 수 있다

그룹에 할당되어있는 행위만 할 수 있는 것을 랩을 통해 확인해보기

2~3번째 비디오는 랩 하는 절차 설명

비디오를 보고 수행하면 된다!



권한 정책을 이 그룹에 제한적으로 일회성으로 사용한다--> 인라인 정책 사용하면 됨

EC2 admin은 인라인 정책

EC2 support는 Readonly access

![image-20210225143723818](C:\Users\MIN\AppData\Roaming\Typora\typora-user-images\image-20210225143723818.png)

일반적인 서비스에 대한 정책들은 대부분 만들어져 있음





### 서비스의 종류에 따라 정책을 기술하는 방법이 조금 다르다!

기본적으로 명시적으로 활성화 하지 않으면 접근 불가

master: 모든 접근 다 가능! 수정/중지/열람 모두 가능.

user -1 S3 에는 접근 가능--> list/get 만 가능

user-2 : Support Group에 적용되어 있는 정책--> EC2 열람가능(ReadOnly)/IAM 열람불가

​	- EC2 인스턴스 중지 불가

user-3: EC2 인스턴스 중지 가능(IAM에서 사용자 그룹의 리소스에 대한 접근통제 정책을 수립해놨기 때문- admin 계정)





개발자가 따라야 하는 정책을 만든다-> 처음에는 EC2 인스턴스를 읽고 조회하고 실행하고 중지하는 것들을 할 수있도록/S3 버킷에 대해 조회할 수 있도록 함

이 개발 정책을 웹 개발자/DB 개발자 그룹에도 적용/사용자에도 적용

​	웹 개발자 그룹에 들어있는 다른 사람들

 정책을 일관되게 적용한다--> 정책의 내용이 가변적으로 바뀔 가능성이 있다/ 동시에 다 적용되게 하고 싶다--> 관리형 정책 사용한다

1.AWS 에서 만든 것(AMAZON S3 READONLYACCESS): 일반적으로 잘 바뀌진 않지만 서비스 상에서 발생할 수 있는 권한 정책들을 만들어놓았다

2. 커스텀화 된 사용자 정의 정책: 내가 적용한 정책을 만들어서 정책 이름 붙이기 가능

일괄되게 적용하려면 모든 것을 다 찾아서 뜯어고쳐야됨: 인라인정책

관리형 정책: 기본적으로 제공되는 것이 있다

커스터마이징 가능한 정책이 있다



S3서비스

개인, 어플리케이션, AWS 서비스의 데이터(=파일)를 보관

- 백업, 로그 파일, 재해 복구 이미지 유지 관리
- 분석을 위한 빅데이터 저장
- 정적 웹 사이트 호스팅 ⇐ 

파일 삭제되지 않도록 보안--> 엄청난 내구성: AWS 리전 내에서 최소 3개의 물리적 가용 영역에 자동으로 분산해서 저장

AWS: 가지고 있는 데이터센터

가용 영역: 물리적으로 떨어진 곳에 동일한 형태로 구성해두는 것

데이터 저장 시 물리적 가용 영역에 분산해서 저장한다 --> 하나가 죽더라도 복구 가능하도록 구성을 가지고 간다

높은 수치의 가용성 제공

서비스를 믿고 맡기면 원하는 시점에 제공 가능!

1년으로 치면 20분~30분을 제외하고는 서비스가 제공되는 것!

그 시간을 초과하게 되면AWS 측에서 보상해주게 되어 있음





**Introduction: Creating a Basic Lifecycle Policy**

- 로컬에 가지고 있는 오브젝트들을 모아서 폴더에 저장한다
- 폴더들이 준비되면 버켓을 준비해서 S3 버켓을 만들어서 그 안에 폴더를 넣는다
- 업로드 준비가 완료되면 lifecycle policy를 만들어서 오브젝트들을 Glacier archive 브릿지

이전 버전 객체 URL 로 접근하면 이전 버전을 볼 수 있다



수명주기: 생성되고 소멸되는 변화들에 대해 행위를 취할 수 있다.

필터: 해당 단어가 들어가면 적용하겠다







------------------

내가 몰라서 적는 개념 정리

(모르는 개념이 없을때까지 정리 예정)





## 1. nginx

> 가벼움과 높은 성능을 목표로 하는 웹 서버 소프트웨어

- **동시접속 처리에 특화**
- **Apache 보다 동작이 단순**하다
  -  정적 파일을 처리하는 HTTP 서버로서의 역할
  - 응용프로그램 서버에 요청을 보내는 **리버스 프록시로서의 역할**
    - 가짜 서버에 요청-> 프록시 서버가 리버스 서버로부터 데이터를 가져옴
    - 프록시 서버:Nginx/ 리버스 서버: 응용프로그램 서버



## 2. Proxy

> 직접 통신할 수 없는 두 점 사이에서 통신할 경우 그 상이에 있어서 **중계기로서 대리로 통신수행하는 기능**

클라이언트 호스트에서 프록시 서버: 원격서버처럼 동작

원격 서버에서 프록시 서버: 클라이언트처럼 동작

- 프록시 서버에 요청된 내용들--> **캐시를 이용하여 저장**

- 캐시 안에 있는 정보를 요구하는 요청에 대해 원격 서버에 접속하여 **데이터를 가져올 필요X**

  => **전송 시간 절약 가능**

  => **불필요하게 외부와의 연결을 하지 않아도 됨**

- 외부와의 트래픽 감소=>**네트워크 병목 현상 방지 효과**

- 프록시 서버 종류

  - **Forward 프록시**
    
    - 프록시 서버를 클라이언트 호스트들과 접근하고자 하는 원격 리소스의 사이에 위치시키는 것
    - 원격 서버로부터 요청된 리소스를 가져옴=> 요청한 사용자에게 돌려주는 역할 수행
  - **Reverse 프록시**
    - 프록시 서버를 인터넷 리소스 또는 인트라넷 리소스 앞에 위치시키는 방식
    - 최종 사용자가 요청 리소스에 직접 접근하는것처럼 느껴짐
    - 각 요청에 대한 데이터가 캐시=> 실제 서버들을 위한 부하조절 기능
    
    

### 3. Module

> 프로그램을 구성하는 **구성 요소의 일부**

- 관련된 데이터/함수들이 묶여서 모듈 형성
- **파일 단위로 나뉨**

- 주로 **기능별로 나뉘어지는 프로그램을 지칭**
  - **모듈화 프로그래밍**: 기능별로 파일을 나눠가며 프로그래밍 하는 것
    
    - 유지 보수성이 좋아진다
    
    

### 4. OpenSSL

> 웹브라우저와 **서버 간의 통신을 암호화하는 오픈소스 라이브러리**

- OpenSSL은 아파치나 엔진엑스 같은 곳에서 자유롭게 사용할 수 있음
- 수많은 사이트들이 사용중



### 5. Library

> 다른 프로그램들과 링크되기 위하여 존재하는 **하나 이상의 서브루틴이나 함수들의 집합 파일**

- 사용자의 프로그램과 연결되어 실행이 가능하다

- **정적 라이브러리**

  - 라이브러리에 포함된 오브젝트 코드가 **실행 프로그램 컴파일 시에 실행 파일에 포함되어 배포**되는 방식
  - 정적 라이브러리의 단점은 **실행 프로그램의 크기가 커지는 문제**뿐만 아니라, 동일한 라이브러리를 포함한 유사 프로그램들이 동시 실행 될 경우 **메모리 자원이 낭비**되는 문제 발생
  - 점점 복잡해지는 소프트웨어 구조 상 **실행 파일 크기가 기하급수적으로 커지는 단점**

- **동적 라이브러리**

  - 필**요할 때만 라이브러리를 메모리로** 불러들이기 때문에 **동적 라이브러리**라고 부른다

  - 실행 파일의 크기를 줄여주며 **사용이 끝나면 메모리에서 삭제**

    => **보다 효율적으로 사용 가능**

### 6. htpasswd

> 아파치로 운영중인 웹서버에 접근할 때 사용자 인증을 하는 기능

- 기본적으로 **모든 사용자들이 볼 수 있도록 구성**되어 있음
  - `htpasswd`를 사용하면 **일부 사용자만 볼 수 있게** 만들 수 있다
- **아파치가 설치된 서버에서 사용 가능**