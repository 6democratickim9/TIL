AWS 가지고 있는 컴퓨터 리소스 공유

클라우드: 운영체제/미들웨어/데이터베이스 스토리지

원래 가지고 있었던 리소스들 재분할해서 사용하는 중

네이버나 LG-> 클라우드 컴퓨터 클러스터링 구축

로컬에 저장해두었던 것들을 클라우드로 이전하는 계획을 가지고 있음

도커/쿠버네티스: 가상화하고 관리시켜주는 솔루션

미들웨어 성격을 가지고 있음



클라우드 도입 하려는 이유: 로컬에서 데이터를 운영하기 위해서는 하드웨어를 준비해야 됨

하드웨어를 추가해서 사용함. 점점 데이터가 늘어나면 늘어날수록 유지보수비용이 점점 더 늘어남

=> 서비스 구축/ 파이널 프로젝트 작업

클라우드 인프라 구축

-> 다른 Ai/빅데이터를 사용할 수 있도록 공간 확보 작업이 주

해당 작업에 있어서 네트워크 및 여러 팀들과 사람들이 사용할 수 있도록 인프라 준비

반드시 네트워크라고 해서 로컬이 아니라 다른 지역의 컴퓨터 파워를 사용하는 것

로컬의 한계를 느꼈기 떄문에 확장성에 있어서 비용 및 속도적인 측면에서 유리

리소스가 부족하면 서버작업 필요/로드 밸런서 등으로 부하 보충

=> 자동화 및 리소스 재사용 부분 고려

클라우드 아키텍쳐 고려

비용 및 속도적인 측면에서 생각해보아야 함

도커 및 쿠버네티스 두 가지는 클라우드 서비스-> 가상화의 기술, 가상화 관리하는 역할로 분류

오픈스택: 하이브리드,프라이빗 클라우드 구축의 솔루션



도커/쿠버네티스/AWS사이의 연관성

도커/쿠버네티스는 연관성이 없을 수 있음-> 각자 하는 일이 다르기 때문

2019년도에 사업자가 오픈소스에서 다른 사업자로 넘어갔기 때문에 오라클의mysql처럼 유료화 될 수 있음

-> 도커 지원에서 다른 순수 오픈소스의 컨테이너 기술로 전환중

도커 자체도 서비스를 지속적으로 지원해야 하기 때문에 쉽게 유료화하지 않을 것

컨테이너 가상화 기술: 도커 외에도 container d, cri-o 가 생김

컨테이너 가상화: 마리아db 등과 유사

mysql은 오픈소스이지만 오라클 소유

아직까지 유료화 소프트웨어는 아님

핵심 엔지니어들이 만들었던 순수 오픈소스 db: mariadb

오라클도 무료로 사용 가능

기업에서는 유료

데이터베이스는 특징에 따라 선택하게 될 것

도커/크리-오/컨테이너d가 있음

(제품명들)-> 나머지 두 개도 오픈소스

정확하게 서비스 사용자와 사용 용도를 모르기 때문에 스스로 갖고있는 서비스에 맞춰 커스터마이징 필요

도커는 그대로 사용해도 괜찮다





쿠버네티스

도커와는 직접적인 관련이 없을 수 는 있어도 중요

컨테이너 가상화에 필요한 도커 및 다른 소프트웨어에 대한 컨트롤타워 역할

세 가지 컨테이너 없이 쿠버네티스 단독으로 사용할 수 있는 것은 아님



쿠버네티스의 파드: 최소 단위

파드는 엄밀히 말해 그 안에 여러 컨테이너들 포함 가능

파드 안의 개별적 요소들은 도커 및 관련 소프트웨어로 생성 가능



AWS와 도커, 쿠버네티스는 다른 얘기

AWS- public cloud/ 부분 유료

AWS 서비스 종류는 350여가지. 



쿠버네티스: 도커와 같은 제품들을 컨트롤 하는 역할

도커가 반드시 있어야 하는 것X

컨테이너 가상화 제품이 반드시 있어야 하는 것O

쿠버네티스에서 운용 가능한 단위: Pod

pod 안의 개별적인 요소들은 도커로도 만들 수 있음

도커나 cri-o , container d중 하나가 있어야 함



AWS는 퍼블릭 클라우드의 가장 대표적인 서비스

상용화된 클라우드 서비스

무료/유료 부분 나뉨

AWS 서비스는 미국 기준으로 했을 때 350여가지가 된다고 함

RDS/S3를 포함하여 구입을 하지 않더라도 네트워크만 연결되어 있어도 잘 사용할수 있음

미들웨어/블록체인/머신러닝 등 모두 가능

서비스에는 정해진 것이 없다



웹액스/줌은 설치해야 됨

설치하지 않고도 사용 가능



VPC,서브넷

- VPC

- 서브넷

  - 같은 네트워크에 묶인 공간

  - 같은 네트워크에 연결된 다른 PC들-> 통신에 제약 없음

  - 같은 네트워크 대역인지 확인하기 위해 사용

  - IP주소: 0~255.0~255.0~255.0~255

    - 256*256*256*256

    - 이렇게 네 자리로 되어 있음

    - 개별적인 IP로 되어 있음

    - 가상의 네트워크를 만들자!

    - 외부와의 통신은 어려워도 내부적으로 통신 가능

      외부의 다른 서비스는 반드시 통과해야 되는 지점: 게이트웨이

      내부적인 네트워크는 수십, 수만개가 되어 있음

      VPC는 AWS에서 사용되는 개녕

      - virtual private cloud
      - 가상의 개인 네트워크
      - AWS에서는 클라우드라는 개념= virtual private cloud라고 부른다

- 네트워크가 있어야 내부-외부로 소통 가능
- 네트워크 구축 필요!
- VPC 필요하면 서브넷 구성 가능
- IP 주소는 v6 가 나왔다
- 16진수까지 포함하여 도입된 바 있음
- PC가 가지는 고유한 주소값으로는 여전히IPv4 사용중
- 가상의 서브넷 네트워크를 만들어서 사용중











## kubernetes

#### node

- 가장 큰 단위로, master노드 필수

  리눅스로 돌아가는 컴퓨터



- 쿠버네티스의 기본 단위: pod
- pod안에 컨테이너가 있음
- scale-in/scale-out으로 나뉨
- 마이크로서비스 아키텍쳐에서 가장 중요한 것: 서비스가 기존 하나의 큰 덩어리에서 만들어지는 것이 아닌
- 쪼개져서 만들어지는 것-> 각각의 서비스들은 독립적으로 배포될 수 있고 개발될 수 있고 패키징 될 수 있는 단위
- 결론적으로 하고자 하는 목적은 서비스들이 연결되어서 서비스를 구축하는 것이 목적이지만
- 배포/ 개발은 개별적으로 될 것임



- 서비스들에 어디에/누가/어떤 것이/누구에게 가야되는지의 정보를 가지는 것이 서비스 디스커버리
- 서비스 레지스트리라고도 부름
- 서비스 디스커버리라는 것은 어디에 있는지 알아보는 것
- 서비스라고 부르는 것
- 서비스를 가지는 플랫폼에 등록하고 필요없다면 삭제-> 서비스 레지스트리
- 레지스트리와 디스커버리는 각각 다른 역할이지만 등록되지 않으면 검색할 수 없고 역도 성립되지 않음
- 우리가 만들었던 개별적인 마이크로 서비스들의 위치 정보를 가지고 있기 떄문에 등록
- 위치 정보를 가지고 알려주고 서비스 정상 실행 해주고 서비스를 다시 원상복구도 가능하게 도와줌
- 해당하는 컨테이너 복구가 되지 않는다면 이런 컨테이너의 기본적 갯수 유지하게 도와주는 기능
- 계속 retry 시키다가 새로운 인스턴스 생성
- 유지 시켜줘야 되는 갯수를 맞출 수 있게끔
- 서비스 인스턴스들을 작동시켜 서비스를 유지시켜 다른 쪽의 어플리케이션이 호출할 수 있게 만들어줌
- 서비스 디스커버리/레지스토리:등록

-> 하쉬코프의 컨설- 디스커버리/레지스토리 역할, 이브로카(넷플릭스), 쿠버네티스 

파드 생성 시 이 파드 안에 회원 정보 서비스가 들어간다-> 파이썬으로 만들어진 회원가입

이런 서비스가 들어간 파드라고 친다

두 번쨰 파드는 주문하기가 들어간 파드

두 개의 파드-> 쿠버네티스에서 설치 가능

쿠버네티스에 관련된 yaml파일을 만들고 파드를 만들어 컨테이너로 만든다-> 쿠버네티스의 워크 노드에 설치

-> 여러 개의 도커들이 쿠버네티스의 워크 노드로 등록되어 있을 때 쿠버네티스가 어디로 설치할지 결정하고 설치

노드 1,2,3 번이 있다고 가정

1번 노드에 주문, 2번 노드에 회원

회원가입에서 주문하기에 있는 등등 정보를 알아야 함

이런 정보를 알려주는 것이 디스커버리

서비스 레지스트리 사용/ 쿠버네티스가 파드의 정보 검색-> 서비스 디스커버리 사용

네이밍 서비스라고도 함

마이크로서비스가 특정한 이름으로 등록되어야 하기 때문

마이크로 서비스에서 말하는 네이밍 서비스 등은 조금씩 다른 의미이지만 마이크로서비스를 등록하고 검색한다는 기능에서는 비슷하다고 할 수 있음

실제로 실체화되어있어 쿠버네티스, 유레카 등을 통해 등록, 검색 하는 기능을 수행

컨테이너화 되어 있는 내용을 오케스트레이션 도구로써 사용중

쿠버네티스가 구글에서 시작되었지만 현재 

클라우드



쿠버네티스 클러스터

하나의 공간처럼 사용할 수 있도록 가상의 네트워크 공간을 만들어놓았음



minikube

- 개발 버전으로 테스트용도로 사용
- 마스터에 해당하는 노드와 워크에 해당하는 노드가 모두 한 곳에 있음
- 안정적인 버전이지만 운영상태에 놓고 사용하기 위해서는 리눅스 버전에 설치하는 것을 권장
- centos에 설치하고 마스터 -노드1,2 로 이루어져있음
- 배포 방식-> 파드 배포
- 파드를 배포하던 어떻게 배포하던 가능
- 레플리케이션 형태로 배포 가능
- replicaset/deployment 중요
- 파드 하나에 여러 개 컨테이너가 올 수 있음
- 하나의 파드에 성격 다른 여러 개의 컨테이너 운영 보다는 관련성 있는 컨테이너들을 파드로 만들어 배포 -> 디플로이먼트
- 컨테이너는 무조건 파드로 감싸져 있어야 할 것
- 독립적으로 배포될 것이 아니라 여러 대의 컨테이너 필요
- 회원가입 컨테이너-장바구니 컨테이너- 주문/배송 컨테이너
- 각각의 서비스들을 파드 안에 포함시켜 배포
- 하나의 디플로이먼트에 넣어 배포-> 훨씬 잘 될것
- 마이크로서비스라는 거시 물리적으로 가지고 있는 것을 분산 할 뿐만 아니라 배포/ 테스트에도 용이
- 크론잡/잡
  - pod나 컨테이너 배포용

#### deployment

- 우리가 가 지고 있는 전체 파드, 서비스, 레플리카셋을 배포
- 가지고 있는 파드를 하나의 커맨드를 이용해 배포 및 관리



### service

- 네트워크와 같음
- 외부에서 접근 가능하도록 네트워크를 설정함
- 외부라는 쿠버네티스 오브젝트 리소스 설정



#### ingress

- 쿠버네티스 클러스터 (워크노드-마스터노드)외부에서 파이썬이나 AWS 에서 접근하여 사용할 수 있도록 함
- 오브젝트 종류 중 하나- 게이트웨이(진입로)라고 생각하면 됨
- 진입점에 해당(게이트웨이)-> 쿠버네티스의 게이트워ㅔ이: 인그레스

#### configmap

- 설정에 관련되어 있는 부가적인 정보들은 컨피그맵이라는 오브젝트에 저장

- 키-밸류의 형태로 이루어져 있음

- 다양한 정보들- mysql 등을 사용하기 위해서는 사용자 id 필요할 것. 

- 패스워드와 사용자 id에서 정보 저장을 시킨다고 하면 다른 컨테이너/파드에서 저장되어진 변수 값을 사용할 때 사용 가능

- 대쉬보드의 보안- 컨피그맵의 보안 취약

  

#### presistent volume

- 파드의 저장공간볼륨 만든다

#### persistent volume claim

- 퍼시스턴트 저장공간을 확보해준다

-> 파드 안의 특정 스토리지(저장 공강)이 갑자기 종료되면 해당 스토리지도 같이 없어지는 것이 일반적

저장된 스토리지를 외부의 특정 디렉토리와 같이 연결한다면-> 갑자기 종료되더라도 외부에서 삭제되지 않는 이사 ㅇ파드의 값 계속 사용 가능

외부에 저장된 값 계속 사용 가능





https://landscape.cncf.io/

참고!





#### - explain

​	kubectl explain [--recursive=false] [flags]

- 파드, 노드, 서비스 등의 다양한 리소스에 대한 문서를 출력

#### - describe

​	kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | /NAME | -l label]) [flags]

- 하나 이상의 리소스의 자세한 상태를 표시

마스터에 api server 존재





구글에서는 쿠버네티스 설치를 위해 gke 사용

-> aws에는 eks가 있음

